{"version":3,"sources":["webpack:///webpack/bootstrap c90ea86fc915d7c3b10b","webpack:///./js/app/main.js","webpack:///./js/app/renderer.js","webpack:///./js/app/loader.js","webpack:///./js/app/audio-player.js","webpack:///./js/app/panda.js","webpack:///./js/app/game.js"],"names":["Math","sign","x","isNaN","Number","game","variables","load","Renderer","settings","sprites","layers","contElem","stage","container","style","height","window","innerHeight","scale","clientHeight","render","canvas","realWidth","width","realHeight","y","draw","document","getElementById","Konva","Stage","resizeCanvas","addEventListener","loading","Layer","add","loadingDraw","loadImgs","image","loadImage","Image","hide","forEach","layer","find","on","onStart","Rect","fill","Text","onload","src","Object","assign","pikes","background","scoreText","score","panel","Group","lifes","life","i","offset","space","input","align","inputText","inputTextClone","clone","opacity","startButton","start","pauseText","pause","winText","againButton","again","loseImg1","loseImg2","winImg","finalScore","end","finalScoreText","destroyChildren","inputWord","show","status","text","getScoreString","visible","panda","sprite","img","animation","state","Sprite","wordImg","group","scaleX","rotate","setAnimation","remove","slice","toString","length","word","tween","Tween","node","duration","scaleY","play","Loader","folder","list","Promise","resolve","reject","n","images","key","split","tracks","track","Audio","oncanplaythrough","xhr","XMLHttpRequest","open","JSON","parse","responseText","send","AudioPlayer","channels","bg","effects","currectPlay","name","channel","loop","onloadedmetadata","currentTime","Panda","speedX","setState","ownSpeedX","speedY","speedYEnter","speedYup","calculatePosition","nextState","limitLeft","limitRight","enterY","frameIndex","fearY","limitY","Game","loader","renderer","audioPlayer","loadImagesList","then","loading2","loadAudioList","loading3","loadFolder","data","wordBase","init","delegateEvents","onInput","event","onKeyDown","focus","value","bind","toLowerCase","keyCode","preventDefault","pandaIntervalCount","pandas","words","playTrack","run","setTimeout","lose","maxNumber","minInterval","random","generationChance","generatePanda","inputString","filter","sort","join","action","wordString","rescuePanda","losePanda","splice","deletePanda","renderPanda","finish","timeRate","pauseOn","stop","pauseOff","continue","rnd","floor","speedXvariation","selected","overlay","abs","loadImg","push","initPanda","playInputTween","playDeadTween"],"mappings":"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","file":"main.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c90ea86fc915d7c3b10b","import { Game } from './game.js'\r\n\r\n\r\nMath.sign = Math.sign || function(x) {                                          // polyfill for IE\r\n    x = +x;\r\n    if (x === 0 || isNaN(x))\r\n      return Number(x);\r\n\r\n    return x > 0\r\n      ? 1\r\n      : -1;\r\n  };\r\n\r\n\r\nlet game = new Game( variables );\r\ngame.load();\n\n\n// WEBPACK FOOTER //\n// ./js/app/main.js","export class Renderer {                                                         //render module\r\n\r\n  constructor( settings ) {\r\n    this.settings = settings;\r\n    this.sprites = [];\r\n    this.layers = {};\r\n  }\r\n\r\n  resizeCanvas() {                                                              //Scaling the canvas depending on the screen size.\r\n                                                                                //is executed at the beginning and window resize.\r\n    const contElem = this.stage.container();\r\n    contElem.style.height = window.innerHeight + 'px';\r\n\r\n    const scale = contElem.clientHeight / this.settings.render.canvas.height;\r\n    const realWidth = this.settings.render.canvas.width * scale;\r\n    const realHeight =  contElem.clientHeight;\r\n\r\n    this.stage.width( realWidth )\r\n      .height( realHeight )\r\n      .scale({x: scale, y: scale});\r\n    this.stage.draw();\r\n  }\r\n\r\n  loading() {                                                                   //functions for 3-step loading\r\n\r\n    this.container = document.getElementById( this.settings.render.canvas.container );\r\n    this.stage = new Konva.Stage({\r\n      container: this.container\r\n    });\r\n\r\n    this.resizeCanvas();\r\n    window.addEventListener('resize', () => { this.resizeCanvas() });\r\n\r\n    this.layers.loading =  new Konva.Layer();\r\n    this.stage.add( this.layers.loading );\r\n    this.loadingDraw();\r\n  }\r\n\r\n  loading2() {\r\n    this.settings.render.loadImgs[1].image = this.loadImage;\r\n    this.layers.loading.add(\r\n      new Konva.Image( this.settings.render.loadImgs[1] )\r\n    ).draw();\r\n  }\r\n\r\n  loading3() {\r\n    this.settings.render.loadImgs[2].image = this.loadImage;\r\n    this.layers.loading.add(\r\n      new Konva.Image( this.settings.render.loadImgs[2] )\r\n    ).draw();\r\n  }\r\n\r\n  init() {\r\n\r\n    this.layers.loading.hide();\r\n\r\n    [ 'background', 'sprites', 'panel', 'pause', 'end', 'start' ].forEach( (layer) => {\r\n      this.layers[layer] = new Konva.Layer();\r\n      this.stage.add( this.layers[layer] );\r\n      this[ `${layer}Draw` ]();\r\n    });\r\n\r\n    this.stage.find('.start').on('click touchend', () => this.onStart() );\r\n  }\r\n\r\n  loadingDraw() {\r\n    this.layers.loading.add(\r\n      new Konva.Rect({\r\n        fill: '#89f87f',\r\n        width: this.settings.render.canvas.width,\r\n        height: this.settings.render.canvas.height,\r\n      })\r\n    ).add(\r\n      new Konva.Text( this.settings.render.loading )\r\n    )\r\n      .draw();\r\n\r\n    this.loadImage = new Image();\r\n\r\n    this.loadImage.onload = () => {\r\n\r\n      this.settings.render.loadImgs[0].image = this.loadImage;\r\n      this.layers.loading.add(\r\n        new Konva.Image( this.settings.render.loadImgs[0] )\r\n      ).draw();\r\n    };\r\n\r\n    this.loadImage.src = 'sprites/loading.png';\r\n  }\r\n\r\n  backgroundDraw() {\r\n    Object.assign( this.settings.render.pikes, {\r\n      image: this.sprites.pikes,\r\n      width: this.settings.render.canvas.width,\r\n    });\r\n\r\n    this.layers.background.add(\r\n      new Konva.Image({\r\n        image: this.sprites.background,\r\n        x: 0, y: 0,\r\n        width: this.settings.render.canvas.width,\r\n        height: this.settings.render.canvas.height\r\n      })\r\n    ).add(\r\n      new Konva.Image( this.settings.render.pikes )\r\n    ).draw();\r\n  }\r\n\r\n  panelDraw() {\r\n\r\n    this.scoreText = new Konva.Text( this.settings.render.score );\r\n    this.panel = new Konva.Group( this.settings.render.panel )\r\n      .add( this.scoreText );\r\n\r\n    this.settings.render.lifes.image = this.sprites.life;\r\n    for ( let i = 0; i < this.settings.lifes; i++ ) {\r\n      this.settings.render.lifes.x = this.settings.render.lifes.offset + i *\r\n        ( this.settings.render.lifes.space + this.settings.render.lifes.width );\r\n      this.panel.add(\r\n        new Konva.Image( this.settings.render.lifes ));\r\n    }\r\n\r\n    Object.assign( this.settings.render.input, {\r\n      x: 0,\r\n      width: this.settings.render.canvas.width,\r\n      align: 'center'\r\n    });\r\n    this.inputText = new Konva.Text( this.settings.render.input );\r\n\r\n    this.inputTextClone = this.inputText.clone();\r\n    this.inputTextClone.opacity(0);\r\n\r\n    this.layers.panel\r\n      .add( this.inputText )\r\n      .add( this.inputTextClone )\r\n      .add( this.panel );\r\n  }\r\n\r\n  startDraw() {\r\n    this.settings.render.startButton.image = this.sprites.start;\r\n\r\n    this.layers.start\r\n      .add( new Konva.Image({\r\n        x: 0,\r\n        y: 0,\r\n        width: this.settings.render.canvas.width,\r\n        height: this.settings.render.canvas.height,\r\n        image: this.sprites['bg-start'],\r\n      }))\r\n      .add( new Konva.Image( this.settings.render.startButton ))\r\n      .draw();\r\n  }\r\n\r\n  pauseDraw() {\r\n    this.settings.render.pauseText.width = this.settings.render.canvas.width;\r\n    this.layers.pause.add(\r\n      new Konva.Text( this.settings.render.pauseText ))\r\n      .draw()\r\n      .hide();\r\n  }\r\n\r\n  endDraw() {\r\n    this.settings.render.winText.width = this.settings.render.canvas.width;\r\n    this.settings.render.againButton.image = this.sprites.again;\r\n    this.settings.render.loseImg1.image = this.sprites['end-lose-1'];\r\n    this.settings.render.loseImg2.image = this.sprites['end-lose-2'];\r\n    this.settings.render.winImg.image = this.sprites['end-win'];\r\n\r\n    this.finalScore = new Konva.Text( this.settings.render.finalScore );\r\n\r\n    this.layers.end\r\n      .add( new Konva.Image({\r\n        width: this.settings.render.canvas.width,\r\n        height: this.settings.render.canvas.height,\r\n        image: this.sprites['bg-end']\r\n      }))\r\n      .add( new Konva.Image( this.settings.render.loseImg1 ))\r\n      .add( new Konva.Image( this.settings.render.loseImg2 ))\r\n      .add( new Konva.Image( this.settings.render.winImg ))\r\n      .add( new Konva.Text( this.settings.render.winText ))\r\n      .add( new Konva.Text( this.settings.render.finalScoreText ))\r\n      .add( this.finalScore )\r\n      .add( new Konva.Image( this.settings.render.againButton ));\r\n  }\r\n\r\n  spritesDraw() { }\r\n\r\n  onStart() { }\r\n\r\n  start() {\r\n    this.layers.start.hide();\r\n    this.layers.end.hide();\r\n    this.layers.sprites.destroyChildren();\r\n    this.render({ inputWord: '', score: 0, lifes: this.settings.lifes });\r\n  }\r\n\r\n  pauseOn() {\r\n    this.layers.sprites.hide();\r\n    this.layers.pause.show();\r\n  }\r\n\r\n  pauseOff() {\r\n    this.layers.pause.hide();\r\n    this.layers.sprites.show();\r\n  }\r\n\r\n  end( status, score ) {\r\n    this.finalScore.text( this.getScoreString(score) );\r\n    this.stage.find('.win').visible( status === 'win' );\r\n    this.stage.find('.lose').visible( status === 'lose' );\r\n\r\n    this.layers.end.show()\r\n      .draw();\r\n  }\r\n\r\n  render({ inputWord, lifes, score }) {\r\n    this.inputText.text( inputWord );\r\n    this.scoreText.text( this.getScoreString( score ) );\r\n\r\n    this.stage.find('.life').forEach( (life, i) => {\r\n      life.visible( i < lifes );\r\n    });\r\n\r\n    this.layers.sprites.draw();\r\n    this.layers.panel.draw();\r\n  }\r\n\r\n  initPanda( panda, sprite, img ) {\r\n\r\n    Object.assign( this.settings.render.panda, {\r\n      image: this.sprites.panda,\r\n      animation: panda.state\r\n    });\r\n    panda.sprite = new Konva.Sprite( this.settings.render.panda );\r\n    panda.sprite.start();\r\n\r\n    this.settings.render.wordImg.image = img;\r\n    panda.img = new Konva.Image( this.settings.render.wordImg );\r\n\r\n    panda.group = new Konva.Group({\r\n      x: panda.x,\r\n      y: panda.y,\r\n      scaleX: panda.rotate\r\n    }).add( panda.sprite )\r\n      .add( panda.img );\r\n\r\n    this.layers.sprites.add( panda.group );\r\n\r\n  }\r\n\r\n  renderPanda( panda ) {\r\n\r\n    panda.group\r\n      .x( panda.x )\r\n      .y( panda.y );\r\n\r\n\r\n    panda.sprite\r\n      .setAnimation( panda.state );\r\n\r\n    if ( panda.state === 'dead' || panda.state === 'win' )\r\n      panda.img.hide();\r\n\r\n    panda.group.scaleX( panda.rotate );\r\n\r\n      panda.img\r\n        .scaleX( panda.rotate )\r\n        .x( panda.img.scaleX() == '1'\r\n          ? this.settings.render.wordImg.x\r\n          : this.settings.render.wordImg.x  + this.settings.render.wordImg.width ) ;\r\n  }\r\n\r\n  deletePanda( panda ) {\r\n    panda.group.remove();\r\n  }\r\n\r\n  getScoreString( score ) {\r\n    return this.settings.render.score.text.slice( 0, - score.toString().length ) + score;\r\n  }\r\n\r\n  playInputTween( word ) {\r\n    this.inputTextClone.text( word );\r\n    this.inputTextClone.opacity(1);\r\n    this.inputTextClone.fill( this.inputText.fill() );\r\n\r\n    let tween = new Konva.Tween({\r\n      node: this.inputTextClone,\r\n      duration: .5,\r\n      fill: 'red',\r\n      scaleX: 1.5,\r\n      x: this.inputText.x() - this.inputText.width() * .25,\r\n      scaleY: 1.5,\r\n      y: this.inputText.y() - this.inputText.height() * .25,\r\n      opacity: 0,\r\n    });\r\n\r\n    tween.play();\r\n  }\r\n\r\n  playDeadTween( panda ) {\r\n    let tween = new Konva.Tween({\r\n      node: panda.sprite,\r\n      duration: .5,\r\n      y: 100\r\n    });\r\n\r\n    tween.play();\r\n  }\r\n\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./js/app/renderer.js","export class Loader {                                                           //module of loading functions\r\n\r\n  loadImagesList( folder, list ) {                                              //used for loading sprites\r\n    return new Promise( (resolve, reject) => {                                  //resolved promise returns object with images, where key is img filename without the extension\r\n      let n = 0;\r\n      let images = {};\r\n\r\n      list.forEach( src => {\r\n        const key = src.split('.')[0];\r\n\r\n        images[ key ] = new Image();\r\n        images[ key ].onload = () => {\r\n          n++;\r\n          if ( n === list.length )\r\n            resolve( images );\r\n        };\r\n\r\n        images[ key ].src = `${ folder }/${ src }`;\r\n      });\r\n    });\r\n  }\r\n\r\n  loadAudioList( folder, list ) {\r\n    return new Promise( (resolve, reject) => {                                  //same principle as for images\r\n      let tracks = {};\r\n      let n = 0;\r\n\r\n      list.forEach( src => {\r\n        const key = src.split('.')[0];\r\n        let track = new Audio();\r\n\r\n        track.oncanplaythrough = () => {\r\n          tracks[ key ] = track;\r\n          n++;\r\n          if ( n === list.length)\r\n            resolve(tracks);\r\n        };\r\n\r\n        track.src = `${folder}/${src}`;\r\n\r\n      });\r\n    });\r\n  }\r\n\r\n  loadImg( folder, src ) {                                                        //at the beginning of the game we don't need to load images for all word at once\r\n    return new Promise( (resolve, reject) => {                                  //this function loads the selected image by generation of new panda\r\n      const img = new Image();\r\n\r\n      img.onload = () => resolve( img );\r\n      img.src = `${ folder }/${ src }`;\r\n    });\r\n  }\r\n\r\n  loadFolder( folder ) {                                                          //returns just list of files in folder\r\n    return new Promise( (resolve, reject) => {                                  //so we can easily add images to a folder without the need to edit the code.\r\n      const xhr = new XMLHttpRequest();\r\n\r\n      xhr.open('GET', `php/get-folder.php?folder=${ folder }`);\r\n      xhr.onload = () => resolve( JSON.parse(xhr.responseText));\r\n      xhr.send();\r\n    });\r\n  }\r\n\r\n\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./js/app/loader.js","export class AudioPlayer {                                                      //game sound mode\r\n  constructor() {\r\n\r\n    this.channels = {\r\n      bg: document.getElementById('bg-audio'),                                  //it uses two HTMLAudio elements,\r\n      effects: document.getElementById('effects-audio')                         //the one for playing background music\r\n    };                                                                          //and the one for sound effects ( sound of 'rescue' and 'dying')\r\n    this.tracks = {};\r\n    this.currectPlay = [];\r\n  }\r\n\r\n  playTrack( name, channel, loop = false ) {                                    //playing a track. 'Name' is the name of audio file without extension, 'channel' - see above, loop is used for background music\r\n    this.channels[channel].src = this.tracks[name].src;                         //\r\n\r\n    this.channels[channel].onloadedmetadata = () => {\r\n      this.channels[channel].currentTime = 0;\r\n      this.channels[channel].play();\r\n      this.channels[channel].loop = loop;\r\n    };\r\n\r\n\r\n  }\r\n\r\n  stop( channel ) {\r\n    this.channels[channel].pause();\r\n  }\r\n\r\n  continue( channel ) {\r\n    this.channels[channel].play();                                              //used for background music when returning from a pause\r\n  }\r\n\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./js/app/audio-player.js","export class Panda {\r\n  constructor ( word, settings, x, speedX ) {\r\n    this.word = word;\r\n    this.settings = settings;\r\n    this.setState('enter');\r\n    this.ownSpeedX = speedX;                                                    //keep the speed that we generated for the panda\r\n    this.x = x;\r\n    this.y = - this.settings.render.panda.height;\r\n    this.rotate = Math.sign( speedX );                                          //determine the direction of the panda, depending on the sign of horizontal speed\r\n  }\r\n\r\n  setState( state ) {\r\n    this.state = state;\r\n    switch ( state ) {\r\n\r\n      case 'win':                                                               //when the entered word is correct and the animation is played\r\n      case 'ouch':                                                              //the animation when the panda \"dies\" is played\r\n      case 'dead':\r\n        this.speedX = 0;\r\n        this.speedY = 0;\r\n        break;\r\n\r\n      case 'fly':                                                               //the panda descends, moving in a zigzag\r\n        this.speedX = this.ownSpeedX * - this.rotate;\r\n        this.speedY = this.settings.panda.speedY;\r\n        break;\r\n\r\n      case 'enter':                                                             //when in the beginning the panda quickly descends from above\r\n        this.speedX = 0;\r\n        this.speedY = this.settings.panda.speedYEnter;\r\n        break;\r\n\r\n      case 'rescue':                                                            //when the rescued panda flies up\r\n        this.speedX = 0;\r\n        this.speedY = this.settings.panda.speedYup;\r\n    }\r\n  }\r\n\r\n  action() {\r\n\r\n    if (this.state !== 'dead') {                                                //we define a new position\r\n      this.calculatePosition();                                                 //and from it, as well as from the animation state, determine the state of the panda\r\n      this.nextState();\r\n    }\r\n  }\r\n\r\n  calculatePosition() {\r\n    if ( this.speedX !== 0 &&\r\n      ( this.x < this.settings.panda.limitLeft || this.x > this.settings.panda.limitRight ) )\r\n      this.rotate = - this.rotate;                                              //turn the panda in the opposite direction when it reaches the border\r\n\r\n    this.y += this.speedY;\r\n    this.x += this.speedX * this.rotate;\r\n  }\r\n\r\n  nextState() {\r\n    if (this.state === 'enter' && this.y > this.settings.panda.enterY )\r\n      this.setState('fly');\r\n\r\n    if (this.state === 'win' && this.sprite.frameIndex() === 6)                 //when the animation is over\r\n      this.setState('rescue');\r\n\r\n    if(this.y < - this.settings.render.panda.height && this.state === 'rescue')\r\n      this.setState('saved');\r\n\r\n    if ( this.state === 'fly' && this.y > this.settings.panda.fearY )\r\n      this.setState('fear');\r\n\r\n    if ( this.state === 'fear' && this.y > this.settings.panda.limitY )\r\n      this.setState('ouch');\r\n\r\n    if (this.state === 'ouch' && this.sprite.frameIndex() === 3)                //when the animation is over\r\n      this.setState('dead');\r\n  }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./js/app/panda.js","import { Renderer } from './renderer.js'\r\nimport { Loader } from './loader.js'\r\nimport { AudioPlayer } from './audio-player.js'\r\nimport { Panda } from './panda.js'\r\n\r\nexport class Game {\r\n  constructor( settings ) {\r\n    this.settings = settings;                                                   //Here we pass the variables to the game.\r\n    this.loader = new Loader();\r\n    this.renderer = new Renderer( settings );\r\n    this.audioPlayer = new AudioPlayer();\r\n\r\n    this.renderer.loading();                                                    //Display first loading screen (with one panda)\r\n  };\r\n\r\n  load() {\r\n    this.loader.loadImagesList('sprites',\r\n      [ 'panda.png', 'life.png', 'pikes.png', 'start.png', 'again.png',\r\n        'background.png', 'bg-start.png', 'bg-end.png', 'end-lose-1.png',\r\n        'end-lose-2.png','end-win.png' ])\r\n\r\n      .then( images => {                                                        //Load the sprites, then display second loading screen\r\n        this.renderer.loading2();\r\n        this.renderer.sprites = images;\r\n        return this.loader.loadAudioList('audio',\r\n          [ 'success.mp3', 'fail.mp3', 'background.mp3' ]);\r\n      })\r\n\r\n      .then( tracks => {                                                        //Load the audio files, then display third loading screen\r\n        this.renderer.loading3();\r\n        this.audioPlayer.tracks = tracks;\r\n        return this.loader.loadFolder( this.settings.folder );\r\n      })\r\n\r\n      .then( (data) => {                                                        //Loading list of images and display start screen\r\n        this.wordBase = data;\r\n        this.renderer.init();\r\n        this.state = 'stop';\r\n        this.delegateEvents();\r\n      });\r\n  }\r\n\r\n  delegateEvents() {\r\n    this.input = document.getElementById('game-input');                         //We use input hidden outside of the screen to make it work on mobile devices.\r\n\r\n    this.input.addEventListener('input', event => this.onInput(event) );\r\n    this.input.addEventListener('keydown', ( event ) => this.onKeyDown( event ));\r\n\r\n    this.renderer.stage.on('click touchend', () => {                            //When you click on the canvas, the cursor is focused on the input.\r\n      this.input.focus();                                                       //So you can add other interactive elements to the page, and the game should not intercept events from them.\r\n      this.inputWord = this.input.value;                                        //And then you can return to the game, just by clicking on it! (after you put its on a pause and googled the word ;-) )\r\n    });\r\n\r\n    this.renderer.onStart = this.start.bind(this);\r\n  }\r\n\r\n  onInput(event) {\r\n    this.inputWord = this.input.value.toLowerCase();\r\n  }\r\n\r\n  onKeyDown( event ) {\r\n    if ( event.keyCode === 9 && this.state !== 'stop' ) {                       //Tab\r\n      event.preventDefault();\r\n      this.pause();\r\n    }\r\n\r\n    if( (event.keyCode === 46 || event.keyCode === 13)                          //Delete or Enter. I noticed that I press Enter out of habit. So this can be useful for quickly removing the wrong words.\r\n      && this.state === 'run' ) {\r\n\r\n      this.inputWord = '';\r\n      this.input.value = '';\r\n    }\r\n  }\r\n\r\n  start() {\r\n    this.lifes = this.settings.lifes;                                           //Start settings.\r\n    this.score = 0;\r\n    this.inputWord = '';\r\n    this.state = 'run';\r\n    this.pandaIntervalCount = 0;\r\n    this.pandas = [];\r\n    this.words = this.wordBase.slice();\r\n\r\n    this.renderer.start();\r\n    this.audioPlayer.playTrack('background', 'bg', true);\r\n    this.input.value = '';\r\n\r\n    this.run();\r\n  }\r\n\r\n  run() {\r\n    if( this.state === 'run' ) {                                                //if game isn't paused\r\n      setTimeout(() => {\r\n        this.pandaIntervalCount++;                                              //counts iterations since the last panda generation\r\n\r\n        if ( this.lifes === 0 )\r\n          this.lose();\r\n        else\r\n\r\n        if (this.words.length > 0 || this.pandas.length > 0) {\r\n\r\n          if ( this.words.length > 0 ) {                                        //if there are still words, we generate a panda with a given probability,\r\n            if ( (this.pandas.length     < this.settings.panda.maxNumber        //or generate immediately if the pandas are over\r\n              && this.pandaIntervalCount > this.settings.panda.minInterval\r\n              && Math.random() < this.settings.panda.generationChance )\r\n              || this.pandas.length === 0  )\r\n              this.generatePanda();\r\n          }\r\n\r\n          let inputString = this.inputWord                                      //I left the opportunity to use phrases.\r\n            .split(' ')                                                         //so we check that the entered string contains all the words in the phrase and no other\r\n            .filter( word => word!=='' )\r\n            .sort()\r\n            .join('_');\r\n\r\n          this.pandas.forEach( ( panda, i ) => {                                //We determine for each panda its state and position,\r\n                                                                                //depending on our actions and pandas previous position, then draw its sprite on the canvas.\r\n            panda.action();\r\n            let wordString = panda.word\r\n              .split('_')\r\n              .filter( word => word!=='' )\r\n              .sort()\r\n              .join('_');\r\n\r\n            if ( inputString === wordString )\r\n              this.rescuePanda( panda, i );\r\n\r\n            if ( panda.state === 'dead' )\r\n              this.losePanda( panda, i );\r\n\r\n            if ( panda.state === 'saved' ) {                                    //If the saved panda flew off the screen, we remove it from the array\r\n              this.pandas.splice( i, 1 );\r\n              this.renderer.deletePanda( panda );\r\n            } else\r\n              this.renderer.renderPanda( panda );\r\n          });\r\n\r\n          this.renderer.render({                                                //we draw the screen with the changed parameters\r\n            inputWord: this.inputWord,\r\n            score: this.score,\r\n            lifes: this.lifes\r\n          });\r\n\r\n          this.run();                                                           //next iteration\r\n        } else\r\n          this.finish();                                                        //so if we have no words left and all pandas are saved, we are finishing\r\n\r\n      }, this.settings.timeRate );\r\n    }\r\n  }\r\n\r\n  pause() {\r\n    if ( this.state !== 'pause' ) {\r\n      this.state = 'pause';\r\n      this.renderer.pauseOn();\r\n      this.audioPlayer.stop('bg');\r\n\r\n    } else {\r\n      this.state = 'run';\r\n      this.renderer.pauseOff();\r\n      this.audioPlayer.continue('bg');\r\n      this.run();\r\n    }\r\n  }\r\n\r\n  finish() {\r\n    this.state = 'stop';\r\n    this.audioPlayer.stop('bg');\r\n    this.renderer.end( this.lifes === this.settings.lifes                       //we check whether we have lost pandas, although we have reached the end\r\n      ? 'win'\r\n      : 'lose', this.score );\r\n  }\r\n\r\n  lose() {\r\n    this.state = 'stop';\r\n    this.audioPlayer.stop('bg');\r\n    this.renderer.end( 'lose', this.score );\r\n  }\r\n\r\n  generatePanda() {\r\n    const rnd = Math.floor( Math.random() * this.words.length ),                //random position in words array\r\n      speedX = this.settings.panda.speedX\r\n        * ( 1 + this.settings.panda.speedXvariation - Math.random() / 2 )       //random relative speed variation\r\n        * Math.sign( Math.random() - .5),                                       //random direction\r\n      selected = this.words.splice( rnd, 1 )[0];\r\n\r\n    let overlay = false,\r\n      x;\r\n\r\n    do {\r\n      overlay = false;                                                          //We generate a random x coordinate for the panda and\r\n      x = ( this.settings.panda.limitRight - this.settings.panda.limitLeft )    //check if its sprite is overlayed on another panda\r\n        * Math.random() + this.settings.panda.limitLeft;\r\n\r\n      this.pandas.forEach( panda => {\r\n        if ( panda.y < this.settings.render.panda.height                        //Since the sprites are large, we allow the overlay of 1/4 of the width on each side.\r\n          && Math.abs( panda.x - x ) > this.settings.render.panda.width * 0.25  //That's why changing the size of the panda in the larger direction can cause bugs.\r\n          && Math.abs( panda.x - x ) < this.settings.render.panda.width * 0.75 )\r\n          overlay = true;\r\n      });\r\n    }\r\n    while ( overlay );\r\n\r\n    this.loader.loadImg( this.settings.folder, selected )\r\n      .then( (img) => {\r\n        const panda = new Panda( selected.split('.')[0], this.settings, x, speedX);\r\n\r\n        this.pandas.push( panda );\r\n        this.renderer.initPanda( panda, 'panda', img );\r\n        this.pandaIntervalCount = 0;\r\n      });\r\n  }\r\n\r\n  rescuePanda( panda, i ) {\r\n    this.renderer.playInputTween( this.inputWord );                             //when the correct word is entered\r\n    this.audioPlayer.playTrack('success', 'effects');                           //We haven't yet removed the panda from the array to continue to calculate its position\r\n    panda.setState('win');\r\n\r\n    this.score++;\r\n    this.inputWord = '';\r\n    this.input.value = '';\r\n  }\r\n\r\n  losePanda( panda, i ) {\r\n    this.renderer.playDeadTween( panda );\r\n    this.audioPlayer.playTrack('fail', 'effects');\r\n\r\n    this.pandas.splice( i, 1 );\r\n    this.lifes--;\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./js/app/game.js"],"sourceRoot":""}